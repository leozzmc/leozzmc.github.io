<!DOCTYPE html><html lang="en" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Executing Remote Operations with AWS IoT Jobs: A Hands-On Tutorial | Kevin Liu's Blog || Technical || Travel</title><meta name="author" content="Kevin Liu"><meta name="copyright" content="Kevin Liu"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="What is a Job? A Job is a remote operation that is sent to and executed on one or more devices connected to AWS IoT. For example, you can define a Job that instructs a set of devices to download and i">
<meta property="og:type" content="article">
<meta property="og:title" content="Executing Remote Operations with AWS IoT Jobs: A Hands-On Tutorial">
<meta property="og:url" content="https://leozzmc.github.io/en/posts/aws_iot_jobs.html">
<meta property="og:site_name" content="Kevin Liu&#39;s Blog || Technical || Travel">
<meta property="og:description" content="What is a Job? A Job is a remote operation that is sent to and executed on one or more devices connected to AWS IoT. For example, you can define a Job that instructs a set of devices to download and i">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://leozzmc.github.io/en/img/aws_iot_job.png">
<meta property="article:published_time" content="2024-01-20T07:04:16.000Z">
<meta property="article:modified_time" content="2024-01-20T07:47:10.919Z">
<meta property="article:author" content="Kevin Liu">
<meta property="article:tag" content="AWS">
<meta property="article:tag" content="IoT">
<meta property="article:tag" content="SDK">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://leozzmc.github.io/en/img/aws_iot_job.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Executing Remote Operations with AWS IoT Jobs: A Hands-On Tutorial",
  "url": "https://leozzmc.github.io/en/posts/aws_iot_jobs.html",
  "image": "https://leozzmc.github.io/en/img/aws_iot_job.png",
  "datePublished": "2024-01-20T07:04:16.000Z",
  "dateModified": "2024-01-20T07:47:10.919Z",
  "author": [
    {
      "@type": "Person",
      "name": "Kevin Liu",
      "url": "https://leozzmc.github.io/en"
    }
  ]
}</script><link rel="shortcut icon" href="/en/img/kevin3.png"><link rel="canonical" href="https://leozzmc.github.io/en/posts/aws_iot_jobs.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/en/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-T4SFRRLLZ0"></script><script>window.dataLayer = window.dataLayer || []
function gtag(){dataLayer.push(arguments)}
gtag('js', new Date())
gtag('config', 'G-T4SFRRLLZ0')
btf.addGlobalFn('pjaxComplete', () => {
  gtag('config', 'G-T4SFRRLLZ0', {'page_path': window.location.pathname})
}, 'google_analytics')
</script><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=LXGW+WenKai+TC&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/en/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: true,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Executing Remote Operations with AWS IoT Jobs: A Hands-On Tutorial',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/en/css/style.css"><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg" style="background-color: #f5f1ed;"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/en/img/me.jpg" onerror="this.onerror=null;this.src='/en/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/en/archives/"><div class="headline">Articles</div><div class="length-num">8</div></a><a href="/en/tags/"><div class="headline">Tags</div><div class="length-num">23</div></a><a href="/en/categories/"><div class="headline">Categories</div><div class="length-num">3</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/en/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> Find Posts</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/en/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></li><li><a class="site-page child" href="/en/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></li><li><a class="site-page child" href="/en/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/en/link/"><i class="fa-fw fas fa-link"></i><span> Links</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-language"></i><span> Languages:</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/en/"><i class="fa-fw fas fa-e"></i><span> English</span></a></li><li><a class="site-page child" href="https://leozzmc.github.io/"><i class="fa-fw fas fa-c"></i><span> 中文</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/en/img/aws_iot_job.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/en/"><img class="site-icon" src="https://i.imgur.com/P19VCm0.png" alt="Logo"><span class="site-name">Kevin Liu's Blog || Technical || Travel</span></a><a class="nav-page-title" href="/en/"><span class="site-name">Executing Remote Operations with AWS IoT Jobs: A Hands-On Tutorial</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/en/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> Find Posts</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/en/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></li><li><a class="site-page child" href="/en/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></li><li><a class="site-page child" href="/en/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/en/link/"><i class="fa-fw fas fa-link"></i><span> Links</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-language"></i><span> Languages:</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/en/"><i class="fa-fw fas fa-e"></i><span> English</span></a></li><li><a class="site-page child" href="https://leozzmc.github.io/"><i class="fa-fw fas fa-c"></i><span> 中文</span></a></li></ul></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Executing Remote Operations with AWS IoT Jobs: A Hands-On Tutorial</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2024-01-20T07:04:16.000Z" title="Created 2024-01-20 15:04:16">2024-01-20</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2024-01-20T07:47:10.919Z" title="Updated 2024-01-20 15:47:10">2024-01-20</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/en/categories/Hands-On-Practices/">Hands-On Practices</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="What-is-a-Job"><a href="#What-is-a-Job" class="headerlink" title="What is a Job?"></a>What is a Job?</h1><blockquote>
<p>A Job is a <strong>remote operation</strong> that is sent to and executed on one or more devices connected to AWS IoT. For example, you can define a Job that instructs a set of devices to download and install application or firmware updates, reboot, rotate certificates, or perform remote troubleshooting operations.</p>
</blockquote>
<h1 id="How-to-create-a-Job"><a href="#How-to-create-a-Job" class="headerlink" title="How to create a Job?"></a>How to create a Job?</h1><p>You must create a job document first.</p>
<blockquote>
<p>The Job Document is a description of the remote operations to be performed a Job</p>
</blockquote>
<h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><blockquote>
<p>When you create a Job, you specify a list of targets that are the devices that <strong>should perform the operations</strong>. The targets can be things or thing groups or both. The Jobs feature sends a message to each target to inform it that a Job is available.</p>
</blockquote>
<h2 id="Job-Execution"><a href="#Job-Execution" class="headerlink" title="Job Execution"></a>Job Execution</h2><blockquote>
<p>A Job execution is an instance of a Job on a target device. The target starts an execution of a Job by downloading the Job document. It then performs the operations specified in the document, and reports its progress to AWS IoT. </p>
</blockquote>
<h1 id="Prepare-to-run-a-remote-operation-using-Jobs"><a href="#Prepare-to-run-a-remote-operation-using-Jobs" class="headerlink" title="Prepare to run a remote operation using Jobs"></a>Prepare to run a remote operation using Jobs</h1><ol>
<li>Setup download location (Device Client)</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /home/ubuntu/workshop_dc/downloadLocation</span><br></pre></td></tr></table></figure>
<p>Check if the process successful</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo tail -F /var/log/aws-iot-device-client/aws-iot-device-client.log</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="AWS-IoT-Job-using-embedded-c-SDK"><a href="#AWS-IoT-Job-using-embedded-c-SDK" class="headerlink" title="AWS IoT Job using embedded-c SDK"></a>AWS IoT Job using embedded-c SDK</h1><h2 id="Launch-an-EC2"><a href="#Launch-an-EC2" class="headerlink" title="Launch an EC2."></a>Launch an EC2.</h2><ul>
<li>AMI: ubuntu</li>
<li>t2.micro</li>
</ul>
<p>Networking:</p>
<ul>
<li>VPC CIDR: 10.1.0.0&#x2F;16</li>
<li>Public Subnet: 10.1.0.0&#x2F;24</li>
</ul>
<p>Connect to the instance and install the necessary packages</p>
<h2 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install vim git curl</span><br><span class="line">git clone https://github.com/aws/aws-iot-device-sdk-embedded-c.git --recurse-submodules</span><br><span class="line">cd aws-iot-device-sdk-embedded-c</span><br><span class="line">mkdir -r build/bin/</span><br><span class="line">sudo apt-get install libssl-dev</span><br></pre></td></tr></table></figure>

<h2 id="Create-Things"><a href="#Create-Things" class="headerlink" title="Create Things"></a>Create Things</h2><ul>
<li>Create Thing</li>
<li>Enter Thing Name, press “Next”</li>
<li>Select <strong>Auto-generate a new certificate</strong><br><img src="https://hackmd.io/_uploads/r1wpLeNu6.png" alt="image"></li>
</ul>
<p>Policy</p>
<blockquote>
<p>Make sure that the certificate you create have bind to policy with enough permisssion<br><strong>iot: Connect</strong><br><strong>iot: Receive</strong><br><strong>iot: Publish</strong><br><strong>iot: Subscribe</strong></p>
</blockquote>
<p><img src="https://hackmd.io/_uploads/BJkGPx4_p.png" alt="image"></p>
<h2 id="Download-Certificate"><a href="#Download-Certificate" class="headerlink" title="Download Certificate"></a>Download Certificate</h2><p><img src="https://hackmd.io/_uploads/SkZjLlV_T.png" alt="image"></p>
<p>Upload certificate to EC2</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp -i &lt;local ssh private key&gt; &lt;cert_name&gt;pem.crt  admin@ec2-XX-XXX-XXX-XXX.compute-1.amazonaws.com:/home/admin/aws-iot-device-sdk-embedded-c/build/bin/certificates/</span><br></pre></td></tr></table></figure>

<p>Upload private key</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scp -i TestKeyAccess.pem debace3e049b44eb15d67fad8ab17763cc575604f4d4a1451cc62cd4ef1498ed-private.pem.key ubuntu@ec2-54-167-159-68.compute-1.amazonaws.com:/home/ubuntu/aw</span><br><span class="line">s-iot-device-sdk-embedded-c/build/bin/certificates</span><br></pre></td></tr></table></figure>

<p>Upload certificates</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp -i TestKeyAccess.pem debace3e049b44eb15d67fad8ab17763cc575604f4d4a1451cc62cd4ef1498ed-certificate.pem.crt ubuntu@ec2-54-167-159-68.compute-1.amazonaws.com:/home/ubuntu/aws-iot-device-sdk-embedded-c/build/bin/certificates</span><br></pre></td></tr></table></figure>

<p>Upload AmazonRootCA1.pem</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp -i TestKeyAccess.pem AmazonRootCA1.pem ubuntu@ec2-54-167-159-68.compute-1.amazonaws.com:/home/ubuntu/aws-iot-device-sdk-embedded-c/build/bin/certificates</span><br></pre></td></tr></table></figure>
<p><img src="https://hackmd.io/_uploads/ByhTugNdT.png" alt="image"></p>
<h2 id="AWS-IoT-Jobs-Demo"><a href="#AWS-IoT-Jobs-Demo" class="headerlink" title="AWS IoT Jobs Demo"></a>AWS IoT Jobs Demo</h2><blockquote>
<p>Ref: <a target="_blank" rel="noopener" href="https://aws.github.io/aws-iot-device-sdk-embedded-C/202012.00/docs/doxygen/output/html/jobs_demo.html">https://aws.github.io/aws-iot-device-sdk-embedded-C/202012.00/docs/doxygen/output/html/jobs_demo.html</a></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install curl libmosquitto-dev mosquitto</span><br></pre></td></tr></table></figure>

<h2 id="Create-Job"><a href="#Create-Job" class="headerlink" title="Create Job"></a>Create Job</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">aws iot create-job --job-id t12 --targets &lt;YOUR_THING_ARN&gt; \</span><br><span class="line">  --document &#x27;&#123;&quot;url&quot;:&quot;https://cdn.kernel.org/pub/linux/kernel/v5.x/linux-5.8.5.tar.xz&quot;&#125;&#x27;</span><br></pre></td></tr></table></figure>

<p><img src="https://hackmd.io/_uploads/B10N5g4da.png" alt="image"></p>
<h2 id="Execute-Job-on-the-target-device-run-the-demo-program-with-device-credentials"><a href="#Execute-Job-on-the-target-device-run-the-demo-program-with-device-credentials" class="headerlink" title="Execute Job on the target device run the demo program with device credentials"></a>Execute Job on the target device run the demo program with device credentials</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">jobs_demo_mosquitto -n device1 -h abcdefg123.iot.us-east-1.amazonaws.com \</span><br><span class="line">  --certfile bbaf123456-certificate.pem.crt --keyfile bbaf123456-private.pem.key</span><br></pre></td></tr></table></figure>

<h2 id="Build-the-demo-program"><a href="#Build-the-demo-program" class="headerlink" title="Build the demo program"></a>Build the demo program</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /aws-iot-device-sdk-embedded-c/demos/jobs/jobs_demo_mosquitto</span><br><span class="line">make</span><br></pre></td></tr></table></figure>
<p><img src="https://hackmd.io/_uploads/HkuCie4uT.png" alt="image"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./jobs_demo_mosquitto</span><br></pre></td></tr></table></figure>
<p><img src="https://hackmd.io/_uploads/SyW-nl4_T.png" alt="image"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./jobs_demo_mosquitto -n &lt;Thing Name&gt; -h &lt;YOUR_IOT_ENDPOINT&gt; \</span><br><span class="line">  --certfile bbaf123456-certificate.pem.crt --keyfile bbaf123456-private.pem.key</span><br></pre></td></tr></table></figure>

<p>Endpoint: a2t2vimlyuhccy-ats.iot.us-east-1.amazonaws.com</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">./jobs_demo_mosquitto -n </span><br><span class="line">ThingforExecuteJobs -h a2t2vimlyuhccy-ats.iot.us-east-1.amazonaws.com --certfile ~/aws-iot-device-sdk-embedded-c/build/bin/certificates/debace3e049b44eb15d67fad8ab17763cc575604f4d4a1451cc62cd4ef1498ed-certificate.pem.crt --keyfile ~/aws-iot-device-sdk-embedded-c/build/bin/certificates/debace3e049b44eb15d67fad8ab17763cc575604f4d4a1451cc62cd4ef1498ed-private.pem.key</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://hackmd.io/_uploads/BkeheZNda.png" alt="image"></p>
<p>Check AWSIoTLogv2</p>
<p><img src="https://hackmd.io/_uploads/HJR34ZEdp.png" alt="image"></p>
<p><img src="https://hackmd.io/_uploads/SkKsEb4dp.png" alt="image"></p>
<p><img src="https://hackmd.io/_uploads/ryV9N-4ua.png" alt="image"></p>
<h1 id="The-Download-files-by-Job-can-be-found-in-the-tmp"><a href="#The-Download-files-by-Job-can-be-found-in-the-tmp" class="headerlink" title="The Download files by Job can be found in the tmp"></a>The Download files by Job can be found in the <code>tmp</code></h1><p><img src="https://hackmd.io/_uploads/S17mOZEd6.png" alt="image"></p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p>[+] AWS Workshop- <a target="_blank" rel="noopener" href="https://catalog.workshops.aws/getstartedwithawsiot/en-US/chapter5-jobs/10-dc-setup">https://catalog.workshops.aws/getstartedwithawsiot/en-US/chapter5-jobs/10-dc-setup</a></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://leozzmc.github.io/en">Kevin Liu</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://leozzmc.github.io/en/posts/aws_iot_jobs.html">https://leozzmc.github.io/en/posts/aws_iot_jobs.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/en/tags/AWS/">AWS</a><a class="post-meta__tags" href="/en/tags/IoT/">IoT</a><a class="post-meta__tags" href="/en/tags/SDK/">SDK</a></div><div class="post-share"><div class="social-share" data-image="/en/img/aws_iot_job.png" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/en/posts/752506ab.html" title="Linux Process Deep Dive-1: Knowledge of PID 0 "><img class="cover" src="/en/img/PID0.jpeg" onerror="onerror=null;src='/en/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">Linux Process Deep Dive-1: Knowledge of PID 0 </div></div><div class="info-2"><div class="info-item-1">PID 0 An Idle Process used to swap all pages of processs to&#x2F;from memory&#x2F;backing store. “Swap Process” It was there, so Linux always have CPU to execute something If you try to execute ps command on the clean Ubuntu Linux, you’ll find there was no process with “PID0”  Idle systemcall not supported since kernal 2.3.13   Then how can we prove that PID0 really exist?  Demo Using bpftrace ...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/en/posts/752506ab.html" title="Linux Process Deep Dive-1: Knowledge of PID 0 "><img class="cover" src="/en/img/PID0.jpeg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-12-14</div><div class="info-item-2">Linux Process Deep Dive-1: Knowledge of PID 0 </div></div><div class="info-2"><div class="info-item-1">PID 0 An Idle Process used to swap all pages of processs to&#x2F;from memory&#x2F;backing store. “Swap Process” It was there, so Linux always have CPU to execute something If you try to execute ps command on the clean Ubuntu Linux, you’ll find there was no process with “PID0”  Idle systemcall not supported since kernal 2.3.13   Then how can we prove that PID0 really exist?  Demo Using bpftrace ...</div></div></div></a><a class="pagination-related" href="/en/posts/aws-iot-device-shadow.html" title="Hands-On Practice: AWS IoT Device Shadow"><img class="cover" src="/en/img/pepe_shadow.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-11-08</div><div class="info-item-2">Hands-On Practice: AWS IoT Device Shadow</div></div><div class="info-2"><div class="info-item-1">Intro - What is AWS IoT Device Shadow?In real world, sometime it is difficult to get the actual device state in real time in such IoT scenarios. A device shadow can overcome this challenge, Device Shadow can consider a virtual  virtual representation of a device which managed by the IoT Things resource created in AWS IoT Core.  The Shadow document is a JSON or a JavaScript notation doc that is ...</div></div></div></a><a class="pagination-related" href="/en/posts/e7e295f6.html" title="Hands-On Practice: S3 Gateway Endpoints"><img class="cover" src="/en/img/pepe4.jpeg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-23</div><div class="info-item-2">Hands-On Practice: S3 Gateway Endpoints</div></div><div class="info-2"><div class="info-item-1">What is S3 Gateway Endpoints? Let’s consider a scenario  How could your Lambda function access the content in the S3 bucket?  If you want a service to access the content in the S3 bucket, it usually go through VPC endpoint. S3 supports two types of VPC endpoint,each of which is Gateway endpoint and Interface endpoint   The diffeences between two types of VPC endpoints are listed below    S3 Gat...</div></div></div></a><a class="pagination-related" href="/en/posts/8d39dbf8.html" title="FreeRTOS_Note"><img class="cover" src="/en/img/freertos/pepe.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-12-02</div><div class="info-item-2">FreeRTOS_Note</div></div><div class="info-2"><div class="info-item-1">AWS FreeRTOS FreeRTOS includes libraries for connectivity, security, and over-the-air (OTA) updates. FreeRTOS also includes demo applications that show FreeRTOS features on qualified boards.   FreeRTOS is an open-source project. You can download the source code, contribute changes or enhancements, or report issues on the GitHub site at https://github.com/FreeRTOS/FreeRTOS.  FreeRTOS - Architect...</div></div></div></a><a class="pagination-related" href="/en/posts/889a40ef.html" title="Fleet Provisioning - Provisioning Devices to AWS IoT in Advance"><img class="cover" src="/en/img/OIG.jpeg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-11-09</div><div class="info-item-2">Fleet Provisioning - Provisioning Devices to AWS IoT in Advance</div></div><div class="info-2"><div class="info-item-1">IntroductionWhat is Fleet Provisioning?Fleet Provisioning can be divided into Provisioning by Claim and Provisioning by Trusted User. Provisioning by ClaimDevices can use embedded provisioning claim certificates (special-purpose certificates) and private keys for manufacturing. If these certificates are registered with AWS IoT, the service can exchange them for a unique device certificate that ...</div></div></div></a><a class="pagination-related" href="/en/posts/efc78ef4.html" title="Hands-On Practice: Amazon SNS Fan out to Amazon SQS"><img class="cover" src="/en/img/pepe5.jpeg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-24</div><div class="info-item-2">Hands-On Practice: Amazon SNS Fan out to Amazon SQS</div></div><div class="info-2"><div class="info-item-1">IntroductionAmazon SNS offen works well with Amazon SQS, by subscribing SQS to SNS, the SNS service can push messages to SQS. This may eliminating the need to periodically check or “poll” for updates. What is Amazon SQS?By official definition  Amazon SQS is a message queue service used by distributed applications to exchange messages through a polling model, and can be used to decouple sending ...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comments</span></div></div><div class="comment-wrap"><div><div id="utterances-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/en/img/me.jpg" onerror="this.onerror=null;this.src='/en/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Kevin Liu</div><div class="author-info-description">👍👍👍👍👍</div><div class="site-data"><a href="/en/archives/"><div class="headline">Articles</div><div class="length-num">8</div></a><a href="/en/tags/"><div class="headline">Tags</div><div class="length-num">23</div></a><a href="/en/categories/"><div class="headline">Categories</div><div class="length-num">3</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/leozzmc"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/leozzmc" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:zzmczzmczzmc870125@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #e0ad5a;"></i></a><a class="social-icon" href="https://www.linkedin.com/in/kevin-liu087" target="_blank" title="LinkedIn"><i class="fa-brands fa-linkedin" style="color: #0373fc;"></i></a><a class="social-icon" href="https://www.youtube.com/channel/UC2AU_vpxPu0oKcgZl3UJSNg" target="_blank" title="Youtube"><i class="fa-brands fa-youtube" style="color: #dc1e1e;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">🛫🛬</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#What-is-a-Job"><span class="toc-number">1.</span> <span class="toc-text">What is a Job?</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#How-to-create-a-Job"><span class="toc-number">2.</span> <span class="toc-text">How to create a Job?</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Target"><span class="toc-number">2.1.</span> <span class="toc-text">Target</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Job-Execution"><span class="toc-number">2.2.</span> <span class="toc-text">Job Execution</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Prepare-to-run-a-remote-operation-using-Jobs"><span class="toc-number">3.</span> <span class="toc-text">Prepare to run a remote operation using Jobs</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#AWS-IoT-Job-using-embedded-c-SDK"><span class="toc-number">4.</span> <span class="toc-text">AWS IoT Job using embedded-c SDK</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Launch-an-EC2"><span class="toc-number">4.1.</span> <span class="toc-text">Launch an EC2.</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Installation"><span class="toc-number">4.2.</span> <span class="toc-text">Installation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Create-Things"><span class="toc-number">4.3.</span> <span class="toc-text">Create Things</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Download-Certificate"><span class="toc-number">4.4.</span> <span class="toc-text">Download Certificate</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AWS-IoT-Jobs-Demo"><span class="toc-number">4.5.</span> <span class="toc-text">AWS IoT Jobs Demo</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Create-Job"><span class="toc-number">4.6.</span> <span class="toc-text">Create Job</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Execute-Job-on-the-target-device-run-the-demo-program-with-device-credentials"><span class="toc-number">4.7.</span> <span class="toc-text">Execute Job on the target device run the demo program with device credentials</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Build-the-demo-program"><span class="toc-number">4.8.</span> <span class="toc-text">Build the demo program</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#The-Download-files-by-Job-can-be-found-in-the-tmp"><span class="toc-number">5.</span> <span class="toc-text">The Download files by Job can be found in the tmp</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference"><span class="toc-number">5.1.</span> <span class="toc-text">Reference</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/en/posts/aws_iot_jobs.html" title="Executing Remote Operations with AWS IoT Jobs: A Hands-On Tutorial"><img src="/en/img/aws_iot_job.png" onerror="this.onerror=null;this.src='/en/img/404.jpg'" alt="Executing Remote Operations with AWS IoT Jobs: A Hands-On Tutorial"/></a><div class="content"><a class="title" href="/en/posts/aws_iot_jobs.html" title="Executing Remote Operations with AWS IoT Jobs: A Hands-On Tutorial">Executing Remote Operations with AWS IoT Jobs: A Hands-On Tutorial</a><time datetime="2024-01-20T07:04:16.000Z" title="Created 2024-01-20 15:04:16">2024-01-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/en/posts/752506ab.html" title="Linux Process Deep Dive-1: Knowledge of PID 0 "><img src="/en/img/PID0.jpeg" onerror="this.onerror=null;this.src='/en/img/404.jpg'" alt="Linux Process Deep Dive-1: Knowledge of PID 0 "/></a><div class="content"><a class="title" href="/en/posts/752506ab.html" title="Linux Process Deep Dive-1: Knowledge of PID 0 ">Linux Process Deep Dive-1: Knowledge of PID 0 </a><time datetime="2023-12-13T23:01:50.000Z" title="Created 2023-12-14 07:01:50">2023-12-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/en/posts/8d39dbf8.html" title="FreeRTOS_Note"><img src="/en/img/freertos/pepe.jpg" onerror="this.onerror=null;this.src='/en/img/404.jpg'" alt="FreeRTOS_Note"/></a><div class="content"><a class="title" href="/en/posts/8d39dbf8.html" title="FreeRTOS_Note">FreeRTOS_Note</a><time datetime="2023-12-02T07:50:49.000Z" title="Created 2023-12-02 15:50:49">2023-12-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/en/posts/889a40ef.html" title="Fleet Provisioning - Provisioning Devices to AWS IoT in Advance"><img src="/en/img/OIG.jpeg" onerror="this.onerror=null;this.src='/en/img/404.jpg'" alt="Fleet Provisioning - Provisioning Devices to AWS IoT in Advance"/></a><div class="content"><a class="title" href="/en/posts/889a40ef.html" title="Fleet Provisioning - Provisioning Devices to AWS IoT in Advance">Fleet Provisioning - Provisioning Devices to AWS IoT in Advance</a><time datetime="2023-11-09T07:14:35.000Z" title="Created 2023-11-09 15:14:35">2023-11-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/en/posts/aws-iot-device-shadow.html" title="Hands-On Practice: AWS IoT Device Shadow"><img src="/en/img/pepe_shadow.jpg" onerror="this.onerror=null;this.src='/en/img/404.jpg'" alt="Hands-On Practice: AWS IoT Device Shadow"/></a><div class="content"><a class="title" href="/en/posts/aws-iot-device-shadow.html" title="Hands-On Practice: AWS IoT Device Shadow">Hands-On Practice: AWS IoT Device Shadow</a><time datetime="2023-11-08T08:30:18.000Z" title="Created 2023-11-08 16:30:18">2023-11-08</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2019 - 2025 By Kevin Liu</span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="Toggle Between Traditional and Simplified Chinese">繁</button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll to Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/en/js/utils.js"></script><script src="/en/js/main.js"></script><script src="/en/js/tw_cn.js"></script><div class="js-pjax"><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'dark'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = `%%{init:{ 'theme':'${theme}'}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (false) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null
  const getUtterancesTheme = theme => theme === 'dark' ? 'photon-dark' : 'github-light'

  const loadUtterances = (el = document, key) => {
    if (isShuoshuo) {
      window.shuoshuoComment.destroyUtterances = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }

    const config = {
      src: 'https://utteranc.es/client.js',
      repo: 'leozzmc/Blog_Reply',
      theme: getUtterancesTheme(document.documentElement.getAttribute('data-theme')),
      crossorigin: 'anonymous',
      async: true,
      ...option,
      'issue-term': isShuoshuo ? key : (option && option['issue-term']) || 'pathname'
    }

    const ele = document.createElement('script')
    Object.entries(config).forEach(([key, value]) => ele.setAttribute(key, value))
    el.querySelector('#utterances-wrap').appendChild(ele)
  }

  const changeUtterancesTheme = theme => {
    const iframe = document.querySelector('#utterances-wrap iframe')
    if (iframe) {
      const message = {
        type: 'set-theme',
        theme: getUtterancesTheme(theme)
      };
      iframe.contentWindow.postMessage(message, 'https://utteranc.es')
    }
  }

  btf.addGlobalFn('themeChange', changeUtterancesTheme, 'utterances')

  if (isShuoshuo) {
    'Utterances' === 'Utterances'
      ? window.shuoshuoComment = { loadComment: loadUtterances }
      : window.loadOtherComment = loadUtterances
    return
  }
  
  if ('Utterances' === 'Utterances' || !false) {
    if (false) btf.loadComment(document.getElementById('utterances-wrap'), loadUtterances)
    else loadUtterances()
  } else {
    window.loadOtherComment = loadUtterances
  }
})()</script></div><script data-pjax src="/en/self/btf.js"></script><script data-pjax src="/en/self/tw_en.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script data-pjax src="/self/calendar.js"></script><script data-pjax src="/self/languages.js"></script><script id="canvas_nest" defer="defer" color="34,34,34" opacity="0.8" zIndex="-1" count="350" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>